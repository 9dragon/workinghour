# 项目工时统计WEB软件需求说明书

## 一、基本信息

|字段名称|内容|
|---|---|
|文档版本|V1.1.0|
|文档作者|产品经理|
|创建日期|[当前日期]|
|适用范围|项目工时统计WEB软件的需求定义、开发指导、测试验收|
|关联角色|开发工程师、测试工程师、项目经理、部门负责人、系统使用者|

## 二、产品概述

### 2.1 项目背景

目前需对软件项目工时进行统计分析，数据来源为钉钉用户的OA审批记录。因费用限制，无法通过API接口直接对接钉钉后台数据，需用户从钉钉后台导出Excel文件后，上传至本系统完成数据录入与统计。为满足项目和组织维度的工时查询需求，特开发此轻量WEB软件，简化工时统计流程，提升数据查询效率。

随着项目推进，发现单纯的数据统计无法保证工时数据的准确性和完整性。员工可能忘记提交工时记录或提交不完整，导致项目工时统计结果失真，影响项目管理和决策。因此需要在数据统计之前增加工时核对功能，及时发现并提醒员工补充缺失的工时记录。

### 2.2 产品目标

- 实现钉钉OA审批Excel数据的快速、准确导入，完成工时数据的批量录入。

- 支持按项目维度和组织维度查询工时数据，为项目管理和组织决策提供数据支撑。

- 提供工时核对功能，自动检查员工工时提交的完整性和合规性，及时发现并提醒缺失或异常的工时记录，确保项目工时统计准确可靠。

- 系统设计简洁、易用，降低用户操作成本，无需专业技术背景即可上手使用。

### 2.3 用户画像

- **项目经理**：需查询所负责项目的总工时、加班时长等数据，掌握项目人力投入情况，关注项目成员的工时提交情况，确保项目工时数据完整准确。

- **部门负责人**：需按组织（部门）维度查询工时数据，了解各部门人员的工作投入分布，监督部门员工的工时提交完整性和合规性。

- **行政/人事专员**：负责批量导入工时数据，执行工时核对检查，生成核对报告并通知相关员工补充缺失的工时记录。

### 2.4 范围边界

#### 2.4.1 包含范围

- **核心功能**：Excel数据导入、项目维度工时查询、组织维度工时查询、工时核对。

- **辅助功能**：导入记录查看、查询结果导出（基础Excel格式）、数据校验提示、核对报告导出。

#### 2.4.2 排除范围

- 不支持与钉钉后台的API接口实时对接。

- 不包含复杂的数据分析建模、可视化图表（如折线图、饼图等）功能。

- 不涉及用户权限的精细化管理（如角色权限细分、数据行级权限控制），仅支持基础的登录验证。

- 不支持实时消息通知功能，仅支持系统内报告查看和导出。

### 2.5 核心流程与时序说明

本节通过流程图和时序图直观呈现软件核心业务流程及功能交互逻辑，帮助相关用户快速理解软件设计与使用思路。

#### 2.5.1 核心业务流程图

该图展示软件核心业务（数据导入、工时查询、工时核对）的完整流转逻辑，覆盖从数据准备到结果输出的全流程。

```mermaid
graph TD
    A[用户准备] -->|1.从钉钉后台导出Excel（审批通过/已完成条目）| B[系统登录]
    B --> C{功能选择}
    C -->|选择数据导入| D[Excel文件上传]
    D --> E[系统校验]
    E -->|a.格式校验（.xls/.xlsx）| F{校验结果}
    E -->|b.字段校验（完整性/类型）| F
    E -->|c.状态筛选（仅保留通过/已完成）| F
    E -->|d.唯一性校验（组合标识）| F
    F -->|校验通过| G[有效数据入库+生成导入批次号]
    F -->|校验失败| H[生成导入报告（标注无效数据及原因）]
    G --> I[导入完成提示（成功/重复/无效行数）]
    H --> J[用户查看报告并修正文件]
    J --> D
    I --> C

    C -->|选择工时查询| K{查询维度选择}
    K -->|项目维度| L[设置筛选条件（项目名称/经理/时间范围等）]
    K -->|组织维度| M[设置筛选条件（部门/姓名/时间范围等）]
    L --> N[系统查询数据库]
    M --> N
    N --> O[数据汇总（总工时/加班时长等）]
    O --> P[展示查询结果表格]
    P --> Q{后续操作}
    Q -->|导出结果| R[生成Excel导出文件并下载]
    Q -->|重新查询| K

    C -->|选择工时核对| S[设置核对参数（时间范围/部门/人员）]
    S --> T[执行工时完整性检查]
    T -->|a.每日工作时长检查| U{核对结果}
    T -->|b.工作日缺失检查| U
    T -->|c.异常工时检查| U
    U -->|存在缺失/异常| V[生成核对报告]
    V --> W[展示核对结果（缺失人员/日期/异常数据）]
    W --> X{后续操作}
    X -->|导出报告| Y[生成Excel导出文件并下载]
    X -->|再次核对| S
```

#### 2.5.2 核心功能时序图（Excel数据导入）

该图展示Excel数据导入功能中，用户与系统的交互时序及系统内部处理逻辑。

```mermaid
sequenceDiagram
    participant U as 用户
    participant S as 系统
    participant DB as 数据库
    U->>S: 1.登录系统，进入【数据管理-Excel数据导入】模块
    U->>S: 2.上传钉钉导出的Excel文件
    S->>U: 3.返回文件接收成功提示
    S->>S: 4.执行文件校验（格式/字段/状态/唯一性）
    alt 校验存在无效数据
        S->>S: 5.生成导入报告（标注无效数据行号及原因）
        S->>U: 6.返回导入失败提示，提供导入报告查看/下载
        U->>U: 7.根据报告修正Excel文件
        U->>S: 8.重新上传修正后的文件（重复步骤2）
    else 校验全部通过
        S->>S: 9.筛选出审批通过、审批状态已完成的有效数据
        S->>DB: 10.生成导入批次号，批量写入有效数据
        DB-->>S: 11.返回数据入库成功确认
        S->>S: 12.统计成功导入行数、重复行数（若有）
        S->>U: 13.返回导入完成提示（含成功/重复行数），提供导入报告查看
    end
```

#### 2.5.3 核心功能时序图（工时核对）

该图展示工时核对功能中，用户与系统的交互时序及系统内部处理逻辑。

```mermaid
sequenceDiagram
    participant U as 用户
    participant S as 系统
    participant DB as 数据库
    U->>S: 1.登录系统，进入【工时核对】模块
    U->>S: 2.设置核对参数（时间范围/部门/人员/核对规则）
    S->>DB: 3.查询指定时间范围内的工时数据
    DB-->>S: 4.返回工时数据
    S->>S: 5.执行核对检查
    alt 存在缺失或异常数据
        S->>S: 6.生成核对报告（标注缺失人员/日期/异常原因）
        S->>U: 7.返回核对完成提示，展示核对结果
        U->>U: 8.查看核对报告，通知相关员工
    else 数据完整且无异常
        S->>U: 9.返回核对完成提示（数据完整）
    end
    U->>S: 10.导出核对报告（可选）
    S->>U: 11.生成Excel文件并提供下载
```

## 三、功能清单

|一级菜单|二级菜单|功能描述|优先级|
|---|---|---|---|
|数据管理|Excel数据导入|支持上传.xls/.xlsx格式文件，完成格式、字段、唯一性校验，仅导入审批结果"通过"、审批状态"已完成"的有效数据，生成导入报告并存储数据|高|
||导入记录查看|展示历史导入批次信息（含导入批次号、导入时间、文件名、数据行数等），支持按时间范围筛选，可查看各批次详细导入报告|中|
||导入数据查看|按导入批次号查看该批次成功导入的工时数据详情，支持分页展示和数据导出，用于核对导入数据是否正常存入系统|中|
|工时查询|项目维度查询|支持按项目名称、项目经理、时间范围等条件筛选，展示符合条件的工时数据，提供汇总统计和结果导出功能|高|
||组织维度查询|支持按部门名称、姓名、时间范围等条件筛选，展示符合条件的工时数据，提供汇总统计和结果导出功能|高|
||查询结果导出|将任意维度的工时查询结果导出为Excel文件，文件名按"工时查询结果_查询维度_查询时间"格式生成，包含当前展示的所有字段和数据|中|
|工时核对|工时完整性检查|检查指定时间范围内员工工时提交的完整性，识别缺失工时记录的员工和日期，生成核对报告|高|
||工时合规性检查|检查工时数据是否符合公司规定（如每日工作时长、加班时长上限等），识别异常数据并标注原因|高|
||核对报告导出|将核对结果导出为Excel文件，文件名按"工时核对报告_核对时间范围"格式生成，便于分发和沟通|中|
|系统设置|数据备份与恢复|支持手动触发数据备份（导出SQL脚本），可通过备份文件进行数据恢复，恢复前需用户确认避免误操作|中|

## 四、功能需求

### 3.1 核心功能一：Excel数据导入

#### 3.1.1 功能描述

支持用户上传从钉钉后台导出的工时相关Excel文件，系统对文件进行格式校验、字段校验和数据唯一性校验后，将有效数据批量录入系统数据库。

#### 3.1.2 触发条件

用户登录系统后，进入"数据导入"模块，点击"上传文件"按钮并完成文件选择与确认。

#### 3.1.3 输入要求

- 文件格式：仅支持Excel文件，包括.xls和.xlsx两种格式。
- 文件内容：需包含预设的15个字段，字段顺序可灵活调整，但字段名称需与系统预设字段完全一致（字段清单见本说明书4.1节）。
- 文件大小：单个文件大小不超过10MB，单次导入数据行数不超过1000行（满足轻量使用场景需求）。

#### 3.1.4 业务规则

- 数据筛选规则：系统仅导入并存储审批结果为"通过"、审批状态为"已完成"的条目，其他状态的条目直接判定为无效数据，不纳入系统存储和统计。

- 重复数据处理：以"姓名+开始日期+项目交付-项目名称"作为组合唯一标识；**同批次内**允许同一人同一日期同一项目提交多条工时记录（可能是不同工作内容）；**跨批次**时，与系统已存储数据重复的，系统默认采用"跳过重复数据"策略，仅导入新增的有效数据；支持用户手动选择"覆盖重复数据"策略（覆盖系统中已存在的重复数据）。

- 出错机制：导入过程中若存在无效数据（如字段为空、格式错误、取值异常等），系统仅导入有效数据，同时生成导入报告，明确提示无效数据的行数、错误原因（如"第5行：开始日期格式错误""第12行：项目交付-工作时长为非数值类型"），供用户查看和修正后重新导入。

- 其他规则：导入文件若存在空行、合并单元格、隐藏单元格，或数据位于非第一个Sheet页，对应行数据判定为无效数据；导入过程中用户刷新页面，系统需保障已导入的有效数据不丢失，导入完成后页面自动刷新展示最新数据。

#### 3.1.5 输出结果

- 导入成功提示：显示"导入完成"，并告知本次导入成功的有效数据行数、跳过/覆盖的重复数据行数、无效数据行数。
- 导入报告：支持用户点击"查看导入报告"，查看详细的无效数据信息；支持将导入报告导出为Excel文件。
- 数据存储：有效数据同步录入系统数据库，生成唯一的导入批次号，关联每条数据以便追溯。

### 3.2 核心功能二：工时查询（项目+组织维度）

#### 3.2.1 功能描述

支持用户分别按项目维度和组织维度查询工时数据，可设置多条件组合筛选，查询结果以表格形式展示，支持基础排序和导出。

#### 3.2.2 触发条件

用户登录系统后，进入"工时查询"模块，选择查询维度（项目/组织），设置筛选条件后点击"查询"按钮。

#### 3.2.3 查询维度与筛选条件

##### 3.2.3.1 项目维度查询

核心筛选条件：

- 项目名称：支持模糊查询，下拉选择框展示系统中已存储的所有项目名称（从导入数据的"项目交付-项目名称"字段提取）。
- 项目经理：支持模糊查询，下拉选择框展示系统中已存储的所有项目经理（从导入数据的"项目交付-项目经理"字段提取）。
- 时间范围：支持按"开始时间"或"结束时间"设置查询时间段（如"2026-01-01 至 2026-01-31"），时间范围不超过1年。
- 审批状态：默认查询"已完成"状态的数据，且仅能查询审批结果为"通过"的条目（系统仅存储此类有效数据）。

##### 3.2.3.2 组织维度查询

核心筛选条件：

- 部门名称：支持模糊查询，下拉选择框展示系统中已存储的所有部门（从导入数据的"创建人部门"字段提取）。
- 姓名：支持模糊查询，可查询指定部门下特定人员的工时数据。
- 时间范围：与项目维度查询的时间范围规则一致。
- 审批状态：默认查询"已完成"状态的数据，且仅能查询审批结果为"通过"的条目（系统仅存储此类有效数据）。

#### 3.2.4 业务规则

- 查询结果排序：默认按"开始时间"降序排列，支持用户手动选择按"项目交付-工作时长""项目交付-加班时长"升序或降序排序。

- 汇总功能：支持按查询维度进行基础汇总，项目维度汇总显示所选项目的总工作时长、总加班时长、涉及人员数量；组织维度汇总显示所选部门的总工作时长、总加班时长、涉及项目数量。

- 数据展示规则：查询结果表格需完整展示15个核心字段，支持页面内分页（每页显示20/50/100行，用户可切换），支持横向滚动查看所有字段。

- 导出功能：支持将查询结果导出为Excel文件，导出文件包含当前页面展示的所有字段和数据，文件名默认格式为"工时查询结果_查询维度_查询时间"。

#### 3.2.5 输出结果

- 查询结果表格：展示符合筛选条件的所有工时数据，包含15个核心字段。
- 汇总信息：在查询结果表格上方展示汇总数据（总工作时长、总加班时长等）。
- 导出结果：生成符合要求的Excel导出文件，支持用户下载到本地。

### 3.3 核心功能三：工时核对

#### 3.3.1 功能概述

工时核对功能用于检查员工工时提交的完整性和合规性，及时发现缺失或异常的工时记录，确保项目工时统计准确可靠。该功能包括两个子功能：工时完整性检查和工时合规性检查。

#### 3.3.2 工时完整性检查

##### 3.3.2.1 功能描述

检查指定时间范围内员工工时提交的完整性，识别未提交工时记录的员工和日期，生成核对报告供管理员查看和分发。

##### 3.3.2.2 触发条件

用户登录系统后，进入"工时核对"模块，选择"工时完整性检查"，设置核对参数后点击"开始核对"按钮。

##### 3.3.2.3 输入要求

- 时间范围：支持设置核对的时间段（如"2026-01-01 至 2026-01-31"），时间范围不超过3个月。
- 部门选择：可选，支持选择特定部门进行核对，不选择则核对所有部门。
- 人员选择：可选，支持选择特定人员（姓名）进行核对，不选择则核对部门内所有人员。
- 工作日定义：可配置工作日（默认为周一至周五），可选择包含或排除节假日。

##### 3.3.2.4 业务规则

- 完整性判断标准：员工在每个工作日内应至少提交一条工时记录，未提交则判定为"缺失"。

- 缺失数据判定：根据"开始时间"字段判断员工在指定日期是否提交了工时记录，若某员工在某个工作日内无任何工时记录，则判定为该员工该日工时缺失。

- 新员工处理：若员工在核对时间范围内有部分日期入职（如15号入职），则仅检查其入职后日期的工时提交情况，入职前的日期不判定为缺失。

- 休假处理：系统暂不自动识别休假（如年假、病假），所有工作日均要求提交工时记录（若休假可通过工作内容说明）。

##### 3.3.2.5 输出结果

- 核对结果展示：以表格形式展示核对结果，包含以下信息：
  - 部门名称
  - 员工姓名
  - 缺失日期（多个日期以逗号分隔）
  - 缺失天数统计
  - 最近一次工时提交日期

- 汇总统计：在核对结果上方展示汇总数据：
  - 核对总人数
  - 存在缺失人数
  - 总缺失天数
  - 完整性百分比

- 核对报告导出：支持将核对结果导出为Excel文件，文件名格式为"工时核对报告_完整性检查_核对时间范围"。

#### 3.3.3 工时合规性检查

##### 3.3.3.1 功能描述

检查工时数据是否符合公司规定的工时标准，识别异常的工时记录（如每日工作时长过短或过长、加班时长超出上限等），生成核对报告。

##### 3.3.3.2 触发条件

用户登录系统后，进入"工时核对"模块，选择"工时合规性检查"，设置核对参数后点击"开始核对"按钮。

##### 3.3.3.3 输入要求

- 时间范围：支持设置核对的时间段（如"2026-01-01 至 2026-01-31"），时间范围不超过3个月。
- 部门选择：可选，支持选择特定部门进行核对，不选择则核对所有部门。
- 人员选择：可选，支持选择特定人员（姓名）进行核对，不选择则核对部门内所有人员。
- 合规规则配置：
  - 每日标准工作时长：默认8小时（可配置）
  - 每日工作时长下限：默认4小时（可配置），低于此值判定为异常
  - 每日加班时长上限：默认4小时（可配置），高于此值判定为异常
  - 每月加班时长上限：默认80小时（可配置），高于此值判定为异常

##### 3.3.3.4 业务规则

- 异常类型判定：
  - **工时过短**：单日工作时长低于下限（如<4小时），判定为"工时过短"异常。
  - **加班超标**：单日加班时长超过上限（如>4小时），判定为"加班超标"异常。
  - **累计超标**：月度累计加班时长超过上限（如>80小时），判定为"累计超标"异常。
  - **时长为负**：工作时长或加班时长为负数，判定为"数据异常"。

- 异常数据统计：按员工维度统计异常数据条数、异常类型分布。

- 合规率计算：合规率 = （1 - 异常记录数/总记录数）× 100%。

##### 3.3.3.5 输出结果

- 核对结果展示：以表格形式展示异常数据，包含以下信息：
  - 部门名称
  - 员工姓名
  - 日期
  - 工作时长
  - 加班时长
  - 异常类型（工时过短/加班超标/累计超标/数据异常）
  - 异常说明（如"工作时长3小时，低于下限4小时"）

- 汇总统计：在核对结果上方展示汇总数据：
  - 核对总记录数
  - 异常记录数
  - 异常人数
  - 合规率

- 核对报告导出：支持将核对结果导出为Excel文件，文件名格式为"工时核对报告_合规性检查_核对时间范围"。

#### 3.3.4 核对结果查看与管理

- 核对历史记录：保存每次核对的记录（核对时间、核对类型、核对参数、核对结果摘要），支持查看历史核对记录。

- 核对报告查看：支持点击查看某次核对的详细报告。

- 核对报告导出：支持将任意核对报告导出为Excel文件，便于管理员分发和沟通。

### 3.4 辅助功能：导入记录查看

支持用户查看历史导入记录，包括导入批次号、导入时间、导入文件名、导入数据行数（成功/重复/无效）、导入人等信息；支持按导入时间范围筛选导入记录；支持点击查看某批次导入的详细报告（与该批次导入时生成的报告一致）。

#### 3.4.1 导入详情报告

**功能描述：**

系统在导入Excel文件时，会自动生成详细的导入报告，记录所有无效数据的错误信息和重复数据的详情。导入报告包含：

1. **导入摘要**
   - 总行数、成功导入行数、重复行数、无效行数
   - 成功率、重复率、无效率（百分比展示）

2. **错误详情列表**
   - Excel行号：对应Excel文件中的行号（包含表头）
   - 错误字段：具体出错的字段名称（如"项目交付-项目名称"、"审批结果"等）
   - 错误原因：详细的错误描述信息

3. **错误类型示例**
   - 字段为空："{字段名}字段为空"
   - 格式错误："工作时长格式错误"
   - 取值异常："审批结果为'--'，仅支持'通过'或'审批通过'"
   - 范围超限："工作时长超过168小时（一周最大时长）"

4. **重复数据详情列表**
   - Excel行号：对应Excel文件中的行号（包含表头）
   - 重复类型：固定为"数据重复"
   - 重复说明：包含序号、姓名、时间、项目的完整描述
   - 原批次号：显示已存在数据所属的导入批次号

**数据存储：**

- 错误详情以JSON格式存储在数据库的`import_records`表的`error_details`字段中
- 重复数据详情以JSON格式存储在数据库的`import_records`表的`repeat_details`字段中
- 支持存储无限制数量的错误和重复数据记录（不限制数量）
- 历史导入记录的详情可永久保存，方便随时查询

**用户交互：**

1. 在导入记录列表中点击"查看详情"按钮
2. 弹出对话框显示导入摘要、错误详情表格和重复数据详情表格
3. 错误详情和重复数据详情分别支持分页展示（20/50/100/200条每页）
4. 可按Excel行号排序
5. 错误字段、错误原因和重复信息高亮显示
6. 无错误或重复数据时显示空状态提示
7. 重复数据详情中的原批次号可点击追溯历史导入记录

### 3.5 辅助功能：导入数据查看

#### 3.5.1 功能描述

支持用户按导入批次号查看该批次成功导入的工时数据详情，用于核对导入数据是否正常存入系统。

#### 3.5.2 触发条件

用户登录系统后，进入"数据管理-导入记录查看"模块，点击某条导入记录的"查看数据"按钮，或通过导入批次号直接访问该页面。

#### 3.5.3 输入要求

- 批次号：通过导入记录列表传入，自动填充且不可修改
- 分页设置：支持选择每页显示行数（20/50/100）

#### 3.5.4 业务规则

- 数据范围：仅展示该批次成功导入的有效数据，不包含重复数据和无效数据
- 展示字段：与工时查询一致，完整展示15个核心字段
- 排序规则：默认按"开始时间"降序排列
- 导出功能：支持将该批次数据导出为Excel文件，文件名格式为"工时导入数据_{批次号}"

#### 3.5.5 输出结果

- 数据表格：展示该批次所有成功导入的工时数据
- 汇总信息：在结果表格上方展示汇总数据（总记录数、总工作时长、总加班时长、涉及人数、涉及项目数）
- 导出结果：生成Excel文件供用户下载

## 五、数据需求

### 4.1 核心数据字段

系统核心数据来源于钉钉导出的Excel文件，包含以下15个字段，字段属性定义如下：

|字段名称|字段类型|是否必填|字段说明|取值约束|
|---|---|---|---|---|
|序号|文本|否|钉钉OA审批记录的序号|无|
|姓名|文本|是|提交OA审批的人员姓名|无|
|开始时间|日期|是|工作开始日期|格式：yyyy-MM-dd（按天统计工时）|
|结束时间|日期|是|工作结束日期|格式：yyyy-MM-dd；结束日期≥开始日期|
|项目交付-项目经理|文本|否|对应项目的项目经理姓名|无|
|项目交付-项目名称|文本|是|工作所属的项目名称|无|
|项目交付-工作时长|数值|是|实际工作时长，单位：小时|≥0，支持1位小数|
|项目交付-加班时长|数值|否|加班时长，单位：小时|≥0，支持1位小数；加班时长≤工作时长|
|项目交付-工作内容|文本|否|具体的工作内容描述|最大长度500字符|
|创建时间|日期时间|否|OA审批记录的创建时间|支持格式：yyyy-MM-dd HH:mm:ss、yyyy-MM-dd|
|当前负责人|文本|否|OA审批当前处理负责人|无|
|审批结果|枚举|否|OA审批的最终结果|仅支持"通过""拒绝""待审批"|
|审批状态|枚举|否|OA审批的当前状态|仅支持"已完成""处理中""已撤销"|
|更新时间|日期时间|否|OA审批记录的最后更新时间|支持格式：yyyy-MM-dd HH:mm:ss、yyyy-MM-dd|
|创建人部门|文本|是|提交OA审批人员所属的部门|无|

### 4.2 数据存储要求

- 数据完整性：确保导入的有效数据完整存储，无字段丢失或数据篡改。

- 数据可追溯性：每条数据需关联导入批次号，便于追溯数据的导入来源和时间。

- 存储性能：支持至少10万条历史数据的存储，查询时响应时间≤3秒（单条件查询）、≤5秒（多条件组合查询）。

### 4.3 数据备份与恢复

系统支持手动触发数据备份功能，备份数据格式为SQL脚本文件，用户可下载备份文件至本地；支持通过备份文件进行数据恢复，恢复过程需提示用户确认，避免误操作覆盖现有数据。

## 六、非功能需求

### 5.1 性能需求

- 响应时间：页面加载时间≤2秒；Excel文件导入（1000行数据）时间≤30秒；查询响应时间≤3秒（单条件）、≤5秒（多条件）；工时核对（100人、90天范围）响应时间≤10秒。

- 并发能力：支持同时在线用户数≤50人，同时导入文件的用户数≤5人，同时执行工时核对的用户数≤10人，无明显性能下降（如页面卡顿、导入失败）。

### 5.2 易用性需求

- 操作流程简洁：核心功能（导入、查询、核对）的操作步骤≤3步，用户无需培训即可完成基础操作。

- 提示信息清晰：所有操作结果（成功/失败）、错误原因、必填项提示均需以简洁易懂的文字展示，避免专业术语堆砌。

- 界面一致性：页面布局、按钮样式、交互逻辑保持一致，降低用户认知成本。

### 5.3 兼容性需求

支持主流浏览器：Chrome（版本≥80）、Edge（版本≥80）、Firefox（版本≥75）、Safari（版本≥14）；支持Windows 10及以上、macOS 10.15及以上操作系统。

### 5.4 可维护性需求

系统代码需保留清晰的注释，数据库表结构设计合理并提供说明文档；支持对系统配置参数（如最大导入文件大小、并发用户数限制、工时核对规则）进行简单修改，无需大量代码调整。

## 七、约束条件

- 技术约束：因费用限制，无法使用付费的云服务、第三方组件或API接口，需基于开源技术栈开发。

- 数据来源约束：仅支持钉钉OA审批导出的Excel文件导入，不支持其他来源（如手动录入、其他系统导出文件）的数据录入。

- 硬件环境约束：无特殊硬件要求，用户可通过普通办公电脑（CPU≥i3、内存≥4GB）访问系统。

- 休假识别约束：系统暂不自动识别员工休假状态（如年假、病假），休假期间仍需员工提交工时记录或通过其他方式说明。

## 八、验收标准

### 8.1 功能验收标准

#### 8.1.1 Excel数据导入功能

- **正常场景**：上传符合要求的Excel文件（1000行有效数据，均为审批结果"通过"、审批状态"已完成"），系统成功导入所有数据，导入报告显示"成功1000行，重复0行，无效0行"，数据存储完整且可通过查询功能检索到。

- **异常场景1**：上传包含5行无效数据（2行姓名为空、3行工作时长为负数，另含2行审批结果"拒绝"条目）的Excel文件，系统仅导入符合条件的有效数据，导入报告准确列出7行无效数据的行数和错误原因（含2行审批状态不符），无效数据未存入数据库。

- **异常场景2**：上传非Excel格式文件（如.txt、.pdf），系统提示"文件格式错误，请上传.xls或.xlsx格式文件"，未执行导入操作。

- **重复数据场景**：上传包含10行重复数据（与系统已存储数据重复）的Excel文件，选择"跳过重复数据"策略，系统导入新增的有效数据，导入报告显示"重复10行，跳过处理"。

#### 8.1.2 工时查询功能

- **项目维度查询**：选择项目名称"XX系统开发"、时间范围"2026-01-01至2026-01-31"，查询结果准确展示该项目在指定时间段内的所有工时数据，汇总信息显示正确的总工作时长和总加班时长，支持按工作时长降序排序。

- **组织维度查询**：选择部门"技术部"、姓名"张三"，查询结果准确展示张三在技术部期间的所有工时数据，导出功能可生成包含所有查询结果的Excel文件，文件格式正确、数据完整。

- **多条件组合查询**：选择部门"产品部"、时间范围"2026-01-01至2026-01-31"、审批状态"已完成"，查询结果仅包含符合所有筛选条件的数据，无遗漏或多余数据。

#### 8.1.3 工时完整性检查功能

- **正常场景**：选择时间范围"2026-01-01至2026-01-31"，系统识别出3名员工存在工时缺失（共15天），核对结果准确列出每名员工的缺失日期，汇总统计显示"核对总人数：50人，存在缺失人数：3人，总缺失天数：15天，完整性百分比：99.5%"。

- **新员工场景**：某员工于2026-01-15入职，核对时间范围为2026-01-01至2026-01-31，系统仅检查该员工01-15至01-31的工时提交情况，01-01至01-14不判定为缺失。

- **无缺失场景**：选择时间范围和部门，所有员工在指定时间范围内均按时提交工时，系统返回"核对完成，数据完整"，核对结果表格为空。

- **报告导出场景**：导出核对报告为Excel文件，文件名格式为"工时核对报告_完整性检查_20260101_20260131.xlsx"，文件包含所有核对结果数据，格式正确。

#### 8.1.4 工时合规性检查功能

- **工时过短场景**：核对时间范围内存在5条工时过短记录（工作时长<4小时），系统准确识别并标注异常类型为"工时过短"，异常说明为"工作时长3.5小时，低于下限4小时"。

- **加班超标场景**：核对时间范围内存在3条加班超标记录（加班时长>4小时），系统准确识别并标注异常类型为"加班超标"，异常说明为"加班时长5小时，超过上限4小时"。

- **累计超标场景**：某员工在核对时间范围内累计加班85小时（超过上限80小时），系统准确识别并标注异常类型为"累计超标"，异常说明为"月度累计加班85小时，超过上限80小时"。

- **无异常场景**：选择时间范围和部门，所有工时数据均符合合规规则，系统返回"核对完成，数据合规"，核对结果表格为空。

- **报告导出场景**：导出核对报告为Excel文件，文件名格式为"工时核对报告_合规性检查_20260101_20260131.xlsx"，文件包含所有异常数据，格式正确。

### 8.2 非功能验收标准

- **性能**：页面加载时间≤2秒；1000行数据导入时间≤30秒；多条件查询（5000条结果）响应时间≤5秒；工时核对（100人、90天范围）响应时间≤10秒。

- **兼容性**：在Chrome、Edge、Firefox、Safari四种浏览器中，所有功能均能正常使用，页面布局无错乱。

## 九、附录

### 9.1 术语表

|术语|定义|
|---|---|
|项目维度查询|以项目为核心筛选条件，查询该项目相关的所有工时数据及汇总信息|
|组织维度查询|以部门（组织）为核心筛选条件，查询该部门相关的所有工时数据及汇总信息|
|工时完整性检查|检查员工在指定时间范围内是否按时提交工时记录，识别缺失工时的员工和日期|
|工时合规性检查|检查工时数据是否符合公司规定的工时标准，识别异常的工时记录|
|导入批次号|系统为每次Excel导入操作生成的唯一标识，格式为"IMP_年月日时分秒_随机数"（如IMP_20260109153025_1234）|
|有效数据|符合系统字段校验规则、无重复的导入数据|
|工时缺失|员工在指定工作日内未提交任何工时记录|
|工时过短|单日工作时长低于预设下限（如<4小时）|
|加班超标|单日或月度累计加班时长超过预设上限|
|合规率|（1 - 异常记录数/总记录数）× 100%，用于衡量工时数据的合规程度|

### 9.2 参考资料

- 《钉钉OA审批数据导出规范》

- 《WEB系统Excel导入功能设计指南》

- 《工时管理制度规范》

### 9.3 版本变更记录

|版本号|变更时间|变更内容|变更人|
|---|---|---|---|
|V1.0.0|2026-01-15|首次完成需求说明书撰写，覆盖核心功能、数据需求、非功能需求等全维度内容|产品经理|
|V1.1.0|2026-01-15|新增工时核对功能模块，包括工时完整性检查和工时合规性检查，完善产品目标和用户画像，修复文档结构和章节编号问题|产品经理|

> （注：文档部分内容可能由 AI 生成）
